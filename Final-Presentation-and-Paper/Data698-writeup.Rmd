---
title: 'Using Machine Learning Algorithms to Predict the likelihood of PCOS based on Demographic, Clinical and Lifestyle Factors'
author: "Leticia Salazar"
date: "May 16, 2023"
output:
  html_document:
    toc: yes
    toc_float: yes
    number_sections: no
    theme: united
    highlight: kate
  pdf_document:
    latex_engine: xelatex
    toc: yes
---

```{=html}
<style type="text/css">
code {
  font-family: "Consolas";
  font-size: 12px;
}
pre {
  font-family: "Consolas";
  font-size: 12px;
}
</style>
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

$~$

## Abstract:

Polycystic Ovary Syndrome (PCOS) stands as a prevalent endocrine disorder affecting women of reproductive age worldwide, presenting a confluence of hormonal imbalances, reproductive irregularities, and potential metabolic complications. Characterized by irregular menstrual cycles, hyperandrogenism, and polycystic ovaries, PCOS poses multifaceted challenges that extend beyond reproductive health, encompassing metabolic disturbances and psychological implications. This complex syndrome, rooted in intricate interplays of genetic predispositions, hormonal dysregulation, and environmental factors, manifests variably among affected individuals. The clinical landscape of PCOS often requires a comprehensive, multidisciplinary approach, incorporating lifestyle modifications, pharmacological interventions, and personalized treatments to address symptoms and reduce associated health risks. Despite ongoing research efforts, elucidating the precise etiology and optimal management strategies for PCOS remains a dynamic area of exploration in contemporary medicine. This research project investigates the current studies on PCOS diagnosis, assessing the effectiveness of various machine learning algorithms including Linear Regression (LM), Logistic Regression, Decision Tree (rpart), Random Forest (randomForest), Gradient Boosting Machines (xgboost or gbm), Support Vector Machines (e1071), Neural Networks (neuralnet), and K-Nearest Neighbors (kknn or class).

$~$

## Key words:

Polysyctic Ovary Syndrome, Polycystic Ovarian Syndrome, PCOS, Women's Health, Machine Learning, Linear Regression, Logistic Regression, Decision Tree, Random Forest, Gradient Boosting, Super Vector Machine, Neural Networks, K-Nearest Neighbors, KNN

$~$

## Introduction:

Polycystic Ovary Syndrome (PCOS) is a hormonal imbalance disorder affecting women of reproductive age. The exact number of women affected by PCOS worldwide is difficult to determine as many cases go undiagnosed but according to the World Health Organization (WHO), there's 3.4% of women who are affected [1].  It may not seem as much, but women make up 49.7% of the today’s population [2], almost 13% of those women are of reproductive age [3], leaving about 17.5 million women who reported to suffer from PCOS. Aside from the toll PCOS takes on your physical and emotional health, it causes problems in the ovaries, making it difficult for women to have a healthy menstrual cycle leading to the development of cysts and infertility. It's important to note that the prevalence of PCOS varies by region and ethnic groups, with some studies suggesting higher rates of PCOS in certain populations [4]. This project will investigate publicly available datasets that will allow us to create predictive models on markers in routine test results to make a diagnosis.

$~$

### Objectives:

My objective for this project is to predict a PCOS diagnosis using machine learning algorithms like logistic regression on markers presented on blood work. Machine learning algorithms have shown promise in advancing our understanding of the disease and improving its diagnosis and treatment. 

I anticipate answering the following questions with my data:

1.	Are there commonalities women with and without PCOS have that can be easily dismissed as normal?

2.	Are there differences for women of different race/ethnic background when it comes to having PCOS? What about women without PCOS?

3.	What is the likelihood of a woman developing PCOS based on her age, ethnicity, and BMI history?

4.	Can we predict the risk of insulin resistance, diabetes, and cardiovascular disease in women with PCOS based on their medical history, hormone levels, and lifestyle factors?

5.	Can we predict the likelihood of successful pregnancy outcomes in women with PCOS based on their age, weight, hormone levels, and treatment history?

6.	Can we predict the long-term health outcomes and quality of life of women with PCOS based on their age, lifestyle factors, hormone levels, and treatment history?

Note: this methodology plan is not exhaustive and may vary depending on the specific research question, dataset, and machine learning algorithm used.



$~$

## Literature Review:

For this project, my emphasis was on discovering literature reviews that validate the relevance of the dataset utilized alongside the chosen machine learning algorithms. In pursuit of this goal, I identified several articles outlined below, including studies related to PCOS and its findings in order to better understand the data I am working with.

1. **A Critical Study of Polycustic Ovarian Syndrome (PCOS) Classification Techniques**: The article discusses the application of data mining techniques in diagnosing Polycystic Ovarian Syndrome (PCOS) in women. It emphasizes the use of classification methods such as Naïve Bayes, Decision Trees, and Neural Networks to predict the likelihood of PCOS based on gathered data. The study uses a dataset obtained from a survey conducted among 119 women aged 18 to 22, focusing on lifestyle and dietary habits. Different classification algorithms are applied and compared for accuracy, with Naïve Bayes demonstrating the highest accuracy of 97.65%. The conclusion suggests integrating clinical reports and ultrasound images to further enhance PCOS prediction and assist in early medical intervention. The article acknowledges contributions from medical professionals and the university in facilitating data collection and guidance throughout the project.

2. **A Review: Brief Insight into Polycustic Ovarian Syndrome**: The article discusses Polycystic Ovarian Syndrome (PCOS), an endocrine disorder impacting women due to ovarian cysts, anovulation, and hormonal imbalances. Around 116 million women worldwide are affected by PCOS, influenced by factors like genetics, lifestyle, and obesity. The disorder's pathophysiology involves hormonal dysfunction, insulin resistance, and excess androgen leading to complications like diabetes and endometrial cancer. PCOS is linked to various risk factors such as genetics, neuroendocrine issues, lifestyle choices, and obesity. The condition leads to hormonal imbalances, particularly increased androgens, which affect folliculogenesis and ovarian function. Insulin resistance, often observed in PCOS, further exacerbates hormonal disruptions and contributes to metabolic issues like diabetes and cardiovascular problems. Treatment options for PCOS mainly focus on managing symptoms. Medications like oral contraceptives, antiandrogens, insulin sensitizers (e.g., metformin, thiazolidinediones), and ovulation-inducing agents (e.g., clomiphene citrate, letrozole) are used to address specific symptoms such as irregular menstruation, hirsutism, and infertility. Lifestyle interventions including diet and exercise play a crucial role in managing PCOS-related symptoms. The article concludes that while various treatments target PCOS symptoms, there's no singular cure. Lifestyle modifications, in addition to pharmacological interventions, are vital for managing the condition's impact on a patient's health. Further research into the pathophysiology and potential herbal or alternative treatments is recommended for improving long-term outcomes in PCOS patients.

3. **A Novel Approach for Polycystic Ovary Syndrome Prediction Using Machine Learning in Bioinformatics**: The article focuses on Polycystic Ovary Syndrome (PCOS), a disorder affecting women's reproductive health due to hormone imbalances, leading to complications such as infertility and pregnancy issues. It discusses the necessity of early detection and proposes a novel approach using advanced machine learning techniques for PCOS prediction. The study employs a dataset with clinical and physical parameters, introducing a novel feature selection technique called CS-PCOS based on optimized chi-squared mechanism. Ten machine learning models are compared, with Gaussian Naive Bayes (GNB) showing superior performance, achieving 100% accuracy, precision, recall, and F1-scores with minimal computational time. The research identifies key factors like prolactin levels, blood pressure, thyroid stimulating hormone, relative risk, and pregnancy as significant in PCOS prediction. It also details exploratory data analysis methods and concludes by suggesting future enhancements such as expanding the dataset and applying deep learning techniques for PCOS prediction.

4. **A Study of Hormonal and Anthropometric Parameters in Polycystic Ovarian Syndrome**: 

5. **Clinical Characteristics of Polycystic Ovary Syndome in Indian Women**: The article investigates the clinical features of Polycystic Ovary Syndrome (PCOS) in Indian women, focusing on identifying different phenotypes of the syndrome. It examines the prevalence of markers like acanthosis nigricans (AN) linked with insulin resistance, obesity, hirsutism, and hypothyroidism in PCOS women. Conducted over 18 months, the study included 120 newly diagnosed PCOS patients and highlighted the following:

  * PCOS Occurrence: The research found PCOS in both obese and non-obese women, with AN and hirsutism occurring in an equal proportion of patients. Hormonal dysfunctions in PCOS manifested together or independently.

  * Infertility: Infertility due to anovulation is a complication of PCOS. However, infertility risks did not significantly differ between obese and non-obese PCOS women.

  * Obesity: While obesity is common in PCOS, the study noted that PCOS occurred in women with normal BMI as well. It found that obesity was not essential to diagnose PCOS.

  * Acanthosis Nigricans: AN, a marker of insulin resistance, was present in a significant proportion of PCOS women, especially among the obese, indicating a higher risk of insulin resistance at comparatively lower BMI levels among Indian PCOS women.

  * Hirsutism and Other Hyperandrogenic Features: The study observed hirsutism, acne, and baldness among PCOS women. While more obese women had hirsutism, there was no direct correlation between hirsutism and obesity. However, both AN and hirsutism were present in a substantial number of patients, especially among the obese, suggesting a potential link between insulin resistance and hyperandrogenism.

The research aimed to identify clinical features that can help subgroup PCOS women based on endocrinological malfunctions for more appropriate treatment selection. It emphasized the need for tailored treatment modalities based on the specific subgroup of PCOS.

6. **Comparative Analysis of Artificial Intelligence in the Diagnosis of Polycystic Ovary Syndrome**: The article explores Polycystic Ovary Syndrome (PCOS) and the challenges in its diagnosis due to its variable symptoms. It highlights the use of Artificial Intelligence (AI), specifically machine learning models, to improve PCOS diagnosis accuracy. Various machine learning techniques like Convolutional Neural Networks (CNN), Artificial Neural Networks (ANN), Support Vector Machines (SVM), Decision Tree (DT), and K-Nearest Neighbors (KNN) were compared for diagnosing PCOS using datasets like ovarian ultrasound images, tongue images, and pulse parameters. The findings revealed that CNN models performed best, achieving accuracies ranging from 85% to 98.12% in different studies. They effectively classified ovarian ultrasound images and detected cysts for PCOS diagnosis. SVMs also showed high accuracies, particularly in tongue image analysis and ultrasound image detection, achieving around 94% accuracy. KNN and Decision Tree models achieved accuracies of 91% and 81%, respectively. The conclusion emphasizes that AI techniques, particularly CNN models, hold promise in improving PCOS diagnosis. However, further advancements are needed through larger datasets, feature selection improvements, and model performance evaluation to enhance the accuracy of PCOS diagnosis. Utilizing ensemble machine learning approaches could also aid in achieving better classification accuracy for PCOS diagnosis.

7. **Comparative Analysis of Machine Learning Algorithms in Diagnosis of Polycystic Ovarian Syndrome**:

8. **DHEA, DHEAS and PCOS:**
This article examines the effect of excess adrenal precursor androgen (APA) production on women with PCOS. The extra-adrenal factors, including obesity, insulin and glucose levels, and ovarian secretions, play a limited role in the increased APA production observed in PCOS.

9. **Early identification of PCOS with commonly known diseases: Obesity, diabetes, high blood pressure and heart disease using machine learning techniques**:

10. **Exercise in polycystic ovarian syndrome: An Evidence-based review**:

11. **Genetic Basis of Polycystic Ovary Syndrome (PCOS) Current Perspectives**:

12. **Hyperparameter Optimization for Machine Learning Models Based on Bayesian Optimization**:

13. **PCOS Detect using Machine Learning Algorithms**:

14. **Phenotype and metabolic profile of South Asian Women with polycystic ovary syndrome (PCOS): results of a large database from a specialist Endocrine Clinic**:

15. **Polycystic Ovarian Syndrome (PCOS) awareness amoing young women of central India**:

16. *Prediction of Polycystic Ovarian Syndrome with Clinical dataset using a novel hydrid data mining classification technique***:

17. **Racial and ethnic differences in the polycystic ovary syndrome metabolic phenotypes**:

18. **SPOSDS: A Smart Polycystic Ovary Syndrome diagnostic system using machine learning**:









The following articles will be resourceful for this project:

**Racial and ethnic differences in the metabolic response of polycystic ovary syndrome:**
This article speaks on the racial and ethnic disparities in the metabolic dysfunction suffered by PCOS and whether markers of metabolic function differ in nondiabetic Asian American (AS), African American (AA), Hispanic White (HW), compared to non-Hispanic White (NHW) women with PCOS.





$~$

## Datasets:

The following datasets will be used in this project:

1.	DataSet for PCOS:
These datasets provide the results of an untargeted metabolomic survey was conducted on the metabolites in the FF of 35 patients with PCOS and 37 age-matched individuals as control
2.	Polycystic Ovary Syndrome (PCOS):
PCOS dataset contains all physical and clinical parameters of patients from 10 different hospitals across Kerala, India.
3.	Menstrual Cycle Data:
Randomized Comparison of Two Internet –Supported Natural Family Planning Methods.


$~$

## Methodology:

This project will investigate mainly publicly available datasets except for one dataset from NICHD Dash that will be used to create predictive models on markers in routine test results to make a diagnosis. Some variables that are included in these datasets are:

*	Age
*	Weight
*	BMI
*	Race/ethnicity
*	Family history of PCOS
*	Menstrual cycle irregularity
*	Hormone levels (e.g., testosterone, LH, FSH)
*	Insulin resistance
*	Physical activity level
*	Diet

I will be using R (statistical performing language) to perform exploratory data analysis to process and analyze the data to check for structural errors and be able to create graphs and perform tests with minimal errors. Once the data is ready to use, I will be splitting the data into a training and test set to be able to use a machine learning algorithm such as logistic regression to create a predictive model. The predictive model will be based on markers (variables mentioned above) used to identify individuals who are at high risk for PCOS and target interventions to manage the condition.

To answer my research question:
* The datasets publicly available and the NICHD Dash looking to obtain all have PCOS and non-PCOS patients including demographic information, medical history, and laboratory tests. Preprocess the data by removing missing values, outliers, and redundant variables. Perform feature selection to identify the most informative variables for prediction.
* Split the dataset into training, validation, and testing sets. The training set is used to train the machine learning algorithm, the validation set is used to tune hyperparameters and prevent overfitting, and the testing set is used to evaluate the performance of the final model.
* Select an appropriate machine learning algorithm for the task at hand, such as logistic regression, decision trees, random forests, support vector machines, or neural networks. Train the algorithm on the training set using various techniques, such as cross-validation and regularization, to optimize its performance.
* Evaluate the performance of the trained model on the validation set using various metrics, such as accuracy, precision, recall, F1 score, and area under the curve. Use feature importance analysis to identify the most influential variables for prediction.
* Tune the hyperparameters of the machine learning algorithm using grid search, random search, or Bayesian optimization to improve its performance on the validation set.
* Select the final model based on its performance on the validation set. Evaluate its performance on the testing set to assess its generalization ability.
* Interpret the results of the machine learning algorithm using various techniques, such as decision trees, feature importance analysis, and partial dependence plots. Visualize the results using graphs, charts, and heatmaps to facilitate understanding and communication.
* Deploy the trained model on new data and disseminate the findings through scientific publications, presentations, and online platforms.

Note: this methodology plan is not exhaustive and may vary depending on the specific research question, dataset, and machine learning algorithm used.

Note 2: data has already been collected, there is no need for me to gather participants, perform exams (such as bloodwork), use medical equipment to collect the data, perform surveys, have a location to perform a study, etc. I will be the sole person studying the data set and conducting the analysis.

$~$

## Assumptions:

While there’s limited information available in the medical field and even less data sets available to analyze, I have some concerns on being successful in predicting a PCOS diagnosis. Yet there are justifications exploring PCOS in depth:

* Identify diagnostic biomarkers that can distinguish PCOS patients from healthy individuals or those with other disorders. These biomarkers can aid in earlier diagnosis and better management of the disease.

* Predict the likelihood of disease progression and the risk of developing complications, such as diabetes and cardiovascular disease, in PCOS patients. This information can guide treatment decisions and improve patient outcomes.

* Develop personalized treatment plans for PCOS patients based on their individual characteristics and medical history. This approach can lead to more effective and targeted interventions.

* Integrate data from various sources, such as electronic health records, imaging studies, and genetic analyses, to provide a more comprehensive understanding of PCOS. This can help identify new pathways involved in the disease and potential targets for therapy.

* Aid in the design and analysis of clinical trials, leading to more efficient and informative studies. This can accelerate the development of new treatments for PCOS.

Early diagnosis and management of PCOS can lead to better health outcomes, improved quality of life, and reduced long-term health risks. Therefore, predicting PCOS diagnosis can have several societal benefits, including:

* Predicting PCOS diagnosis can help healthcare providers identify women at risk of developing PCOS and intervene early with appropriate treatment, such as lifestyle modifications and medication, to prevent or minimize the long-term health consequences of the disorder.

* Early diagnosis and treatment of PCOS can help manage symptoms such as irregular periods, infertility, acne, and excess hair growth, leading to improved physical and mental health outcomes for affected women.

* By predicting PCOS diagnosis and intervening early, healthcare providers can prevent or reduce the need for more expensive treatments or surgeries later in life, resulting in cost savings for individuals, healthcare systems, and society.

* Predicting PCOS diagnosis can increase awareness of the disorder among healthcare providers, patients, and the public, leading to more education, research, and advocacy efforts aimed at improving PCOS diagnosis, treatment, and management.

* Early intervention and management of PCOS can improve the quality of life for affected women, leading to increased productivity, better mental health, and greater overall well-being.

Overall, I'll be able to explore the insights into PCOS pathophysiology, diagnosis, and treatment. Their use in PCOS research can lead to more personalized and effective care for patients with this complex disorder.


$~$

## Experimentation and Results:

$~$

## Conclusion:


My initial assumption was that while there’s limited information available in the medical field and even less data sets available to analyze, I have some concerns on being successful in predicting a PCOS diagnosis. 

$~$

## References:

1.	Bulsara, J., Patel, P., Soni, A., &amp; Acharya, S. (2021, February 10). A review: Brief insight into polycystic ovarian syndrome. Endocrine and Metabolic Science. Retrieved February 23, 2023, from https://www.sciencedirect.com 

2.	World female population, 1960-2022. Knoema. (2022). Retrieved February 24, 2023, from https://knoema.com. 

3.	MarchofDimes. (2022). Population of women 15-44 years by age: United States, 2020. March of Dimes | PeriStats. Retrieved February 24, 2023, from https://www.marchofdimes.org

4.	Engmann, L., Jin, S., Sun, F., Legro, R. S., Polotsky, A. J., Hansen, K. R., Coutifaris, C., Diamond, M. P., Eisenberg, E., Zhang, H., Santoro, N., & Reproductive Medicine Network (2017). Racial and ethnic differences in the polycystic ovary syndrome metabolic phenotype. American journal of obstetrics and gynecology, 216(5), 493.e1–493.e13. https://doi.org

5.	Fehring, Richard J., "Menstrual Cycle Data" (2012). Randomized Comparison of Two Internet-Supported Methods of Natural Family Planning. 7.
https://epublications.marquette.edu

6.	Khan, M. J., Ullah, A., & Basit, S. (2019). Genetic Basis of Polycystic Ovary Syndrome (PCOS): Current Perspectives. The application of clinical genetics, 12, 249–260. https://doi.org/


$~$

## Appendices:

### Appendix A - Figures:

```{r,  out.width="80%", fig.align="center", warning=FALSE, message=FALSE, echo=FALSE}

```


$~$

### Appendix B - Tables:

```{r, out.width="80%", fig.align="center", warning=FALSE, message=FALSE, echo=FALSE}

```


$~$

### Appendix C - R Code:

```{r, eval=FALSE}

```

